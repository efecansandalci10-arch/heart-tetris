<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover">
<title>SEVVAL ❤️ Tetris</title>

<style>
*{margin:0;padding:0;box-sizing:border-box;}

body{
background:#0f0f0f;
height:100dvh;
width:100vw;
overflow:hidden;
display:flex;
justify-content:center;
align-items:center;
padding-bottom:env(safe-area-inset-bottom);
padding-top:env(safe-area-inset-top);
}

canvas{
display:block;
touch-action:none;
}
</style>
</head>

<body>

<canvas id="canvas"></canvas>

<script>
const canvas = document.getElementById("canvas");
const ctx = canvas.getContext("2d");

function resize(){
canvas.width = window.innerWidth;
canvas.height = window.innerHeight;
}
resize();
window.addEventListener("resize", resize);

/* ---------------- INTRO ---------------- */

let mode="intro";
let y=-100;
let velocity=2;
let gravity=0.4;
let bounce=0.7;
let introFinished=false;

function drawIntro(){
ctx.clearRect(0,0,canvas.width,canvas.height);

let fontSize = Math.min(canvas.width/5,100);
ctx.font="bold "+fontSize+"px Arial";
ctx.textAlign="center";
ctx.shadowColor="#ff2e88";
ctx.shadowBlur=30;
ctx.fillStyle="#ff4e8a";

ctx.fillText("SEVVAL ❤️", canvas.width/2, y);
}

function updateIntro(){
velocity+=gravity;
y+=velocity;

let fontSize = Math.min(canvas.width/5,100);

if(y > canvas.height - fontSize){
y = canvas.height - fontSize;
velocity *= -bounce;

if(Math.abs(velocity)<1.5 && !introFinished){
introFinished=true;
setTimeout(()=>{
mode="tetris";
initTetris();
},1200);
}
}

drawIntro();
requestAnimationFrame(loop);
}

/* ---------------- TETRIS ---------------- */

let COLS=10;
let ROWS=20;
let SIZE;
let board;
let piece;

function initTetris(){
board = Array.from({length:ROWS},()=>Array(COLS).fill(0));
resizeTetris();
spawn();
}

function resizeTetris(){
SIZE = Math.floor(canvas.width / COLS);
canvas.height = SIZE * ROWS;
}

function spawn(){
piece={
x:Math.floor(COLS/2),
y:0
};
}

function drawHeart(x,y){
ctx.font=(SIZE-4)+"px Arial";
ctx.fillText("❤️",x*SIZE+2,y*SIZE+SIZE-4);
}

function drawTetris(){
ctx.clearRect(0,0,canvas.width,canvas.height);

board.forEach((row,y)=>{
row.forEach((v,x)=>{
if(v) drawHeart(x,y);
});
});

drawHeart(piece.x,piece.y);
}

function moveDown(){
piece.y++;
if(piece.y>=ROWS){
board[piece.y-1][piece.x]=1;
spawn();
}
}

function moveLeft(){
if(piece.x>0) piece.x--;
}

function moveRight(){
if(piece.x<COLS-1) piece.x++;
}

/* -------- TOUCH FIX (iPhone optimized) -------- */

canvas.addEventListener("touchstart",e=>{
let rect=canvas.getBoundingClientRect();
let touchX=e.touches[0].clientX-rect.left;

if(touchX < canvas.width/3){
moveLeft();
}else if(touchX > canvas.width*2/3){
moveRight();
}else{
moveDown();
}
});

/* Masaüstü */
document.addEventListener("keydown",e=>{
if(mode!=="tetris") return;
if(e.key==="ArrowLeft") moveLeft();
if(e.key==="ArrowRight") moveRight();
if(e.key==="ArrowDown") moveDown();
});

/* ---------------- LOOP ---------------- */

function loop(){
if(mode==="intro"){
updateIntro();
}else{
moveDown();
drawTetris();
setTimeout(()=>requestAnimationFrame(loop),500);
return;
}
}
loop();
</script>

</body>
</html>
